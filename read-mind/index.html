<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>äºŒè¿›åˆ¶è¯»å¿ƒæœ¯</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    /* é¡µé¢æ•´ä½“ */
    body {
      margin: 0;
      padding: 0;
      background: linear-gradient(135deg, #f6f9fc 0%, #f3f8ff 100%);
      font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
      color: #333;
    }

    /* é¡¶éƒ¨æ¨ªå¹… */
    header {
      background: #004f9c;
      color: #fff;
      padding: 20px 10px;
      text-align: center;
      box-shadow: 0 0 8px rgba(0,0,0,.2);
    }
    header h1 {
      margin: 0;
      font-size: 28px;
    }
    header p {
      margin: 8px 0 0;
      font-size: 14px;
      opacity: 0.9;
    }

    /* å†…å®¹ä¸»ä½“å®¹å™¨ */
    .container {
      max-width: 1200px;
      margin: 20px auto 60px auto;
      padding: 0 15px;
    }

    /* å¡ç‰‡åŒºåŸŸ */
    .card-container {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 20px; /* å¡ç‰‡ä¹‹é—´ç•™å‡ºç©ºéš™ */
    }

    /* å•å¼ å¡ç‰‡ */
    .card {
      background: #fff;
      border-radius: 8px;
      width: 300px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      overflow: hidden;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      position: relative;
    }
    .card:hover {
      transform: translateY(-3px);
    }
    
    /* æ­ç§˜æ¨¡å¼ä¸‹çš„å¡ç‰‡äº¤äº’æ ·å¼ */
    .card.reveal-active {
      cursor: pointer;
      border: 2px solid #28a745; /* ç»¿è‰²è¾¹æ¡†æç¤ºå¯ç‚¹å‡» */
    }
    .card.reveal-active:hover {
      box-shadow: 0 0 20px rgba(40, 167, 69, 0.5);
    }
    /* æç¤ºç”¨æˆ·ç‚¹å‡»çš„å›¾æ ‡æˆ–è¦†ç›–å±‚ */
    .card.reveal-active::after {
      content: "ğŸ” ç‚¹å‡»æŸ¥çœ‹äºŒè¿›åˆ¶ç§˜å¯†";
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(40, 167, 69, 0.1);
      color: #155724;
      display: flex;
      justify-content: center;
      align-items: center;
      font-weight: bold;
      opacity: 0;
      transition: opacity 0.3s;
      pointer-events: none; /* è®©é¼ æ ‡äº‹ä»¶ç©¿é€åˆ°å¡ç‰‡æœ¬èº« */
    }
    .card.reveal-active:hover::after {
      opacity: 1;
    }

    .card h3 {
      background: #007bff;
      margin: 0;
      padding: 12px;
      color: #fff;
      font-size: 16px;
      letter-spacing: 1px;
      text-align: center;
      transition: background 0.3s;
    }
    
    .card.reveal-active h3 {
      background: #28a745;
    }

    /* å¡ç‰‡å†…è¡¨æ ¼ */
    .card table {
      border-collapse: collapse;
      margin: 10px auto;
      width: 95%;
    }
    .card table, .card td, .card th {
      border: 1px solid #ccc;
      text-align: center;
    }
    .card td {
      padding: 6px 2px;
      font-size: 14px;
      height: 30px;
      width: 12.5%;
    }

    /* å¡ç‰‡åº•éƒ¨çš„å‹¾é€‰æç¤º */
    .card label {
      display: block;
      padding: 10px;
      text-align: center;
      font-size: 14px;
      cursor: pointer;
      background: #f8f8f8;
      border-top: 1px solid #ddd;
    }
    .card input[type="checkbox"] {
      margin-right: 6px;
      transform: scale(1.2);
      vertical-align: middle;
    }

    /* æŒ‰é’®åŒºåŸŸ */
    .controls {
      text-align: center;
      margin: 20px auto;
    }
    button {
      cursor: pointer;
      padding: 10px 16px;
      margin: 0 10px 10px 0;
      border: none;
      border-radius: 4px;
      background: #007bff;
      color: #fff;
      font-size: 14px;
      transition: background 0.2s ease;
      min-width: 80px; /* ä¿è¯æ–‡å­—å˜åŒ–æ—¶æŒ‰é’®å®½åº¦ä¸ä¹±è·³ */
    }
    button:hover {
      background: #0056b3;
    }
    /* é‡æ–°å¼€å§‹æŒ‰é’®çš„ç‰¹æ®Šæ ·å¼ï¼ˆå¯é€‰ï¼‰ */
    button.restart-mode {
      background: #ffc107;
      color: #333;
    }
    button.restart-mode:hover {
      background: #e0a800;
    }

    #revealBtn.active {
      background: #28a745;
      box-shadow: inset 0 3px 5px rgba(0,0,0,0.2);
    }

    /* ç»“æœåŒºåŸŸï¼ˆåœ¨é¡µé¢åº•éƒ¨ä¿ç•™æ˜¾ç¤ºï¼‰ */
    #resultArea {
      max-width: 600px;
      margin: 0 auto;
      background: #fff;
      padding: 16px;
      border-radius: 8px;
      min-height: 50px;
      line-height: 1.6;
      box-shadow: 0 1px 5px rgba(0,0,0,0.1);
      text-align: center;
    }
    #resultArea p {
      margin-bottom: 10px;
    }

    /* é«˜äº®æ–‡å­— */
    .highlight {
      color: #d9534f;
      font-weight: bold;
    }
    
    .instruction-tip {
      color: #28a745;
      font-weight: bold;
      margin-top: 10px;
      display: block;
      font-size: 0.9em;
      background: #e8f5e9;
      padding: 5px;
      border-radius: 4px;
      text-align: center;
    }

    /* åº•éƒ¨ç‰ˆæƒ */
    footer {
      text-align: center;
      padding: 10px 0;
      font-size: 12px;
      color: #555;
      opacity: 0.7;
      background: #f0f0f0;
      margin-top: 40px;
    }

    /* ================= å¼¹çª—æ ·å¼ ================= */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.6);
      z-index: 9999;
      display: flex;
      justify-content: center;
      align-items: center;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
      backdrop-filter: blur(3px);
    }
    .modal-overlay.show {
      opacity: 1;
      visibility: visible;
    }

    .modal-content {
      background: #fff;
      width: 90%;
      max-width: 600px;
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.4);
      transform: scale(0.8);
      transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      text-align: center;
      position: relative;
    }
    .modal-overlay.show .modal-content {
      transform: scale(1);
    }

    /* é€šç”¨å¼¹çª—æ ‡é¢˜ */
    .modal-header h2 {
      margin: 0 0 15px 0;
      color: #28a745;
      font-size: 24px;
    }
    .modal-tip {
      color: #666;
      font-size: 13px;
      margin-bottom: 15px;
    }

    /* è¯»å¿ƒæœ¯ç»“æœçš„ç‰¹æ•ˆæ ·å¼ */
    .magic-result-title {
      color: #007bff !important;
      font-size: 26px !important;
      margin-bottom: 20px !important;
    }
    .magic-number {
      font-size: 80px;
      font-weight: bold;
      color: #d9534f;
      margin: 20px 0;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
    }
    .magic-phrase {
      font-size: 18px;
      color: #555;
      font-style: italic;
    }

    /* å¼¹çª—å†…çš„è¡¨æ ¼æ ·å¼ï¼ˆæ­ç§˜ç”¨ï¼‰ */
    .modal-table {
      width: 100%;
      margin: 0 auto;
      border-collapse: collapse;
    }
    .modal-table td {
      border: 1px solid #ddd;
      padding: 8px 4px;
      text-align: center;
      vertical-align: middle;
    }

    /* å¼¹çª—å†…ï¼šåè¿›åˆ¶æ•°å­— */
    .cell-decimal {
      font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
      font-size: 18px;
      font-weight: bold;
      color: #333;
      line-height: 1.2;
    }
    
    /* å¼¹çª—å†…ï¼šäºŒè¿›åˆ¶æ•°å­— */
    .cell-binary {
      font-family: "Courier New", Courier, monospace;
      font-size: 14px;
      color: #666;
      margin-top: 4px;
      letter-spacing: -0.5px;
    }

    .modal-bit-highlight {
      color: #d9534f;
      font-weight: 900;
      font-size: 1.25em;
      text-decoration: underline;
    }
    
    /* å…³é—­æç¤º */
    .close-hint {
      margin-top: 20px;
      font-size: 14px;
      color: #999;
      cursor: pointer;
    }
    .close-hint:hover {
      color: #333;
    }

  </style>
</head>
<body>

<header>
  <h1>äºŒè¿›åˆ¶è¯»å¿ƒæœ¯</h1>
  <p>æƒ³ä¸€ä¸ª 1ï½63 çš„æ•°å­—ï¼Œå‹¾é€‰åŒ…å«å®ƒçš„å¡ç‰‡ï¼Œç„¶åç‚¹å‡»â€œè¯»å¿ƒæœ¯â€ï¼</p>
</header>

<div class="container">
  
  <div class="card-container">
    <!-- å¡ç‰‡1ï¼šbit0=1 -->
    <div class="card" id="card1">
      <h3>å¡ç‰‡ 1</h3>
      <table>
        <tbody>
          <tr><td>1</td><td>9</td><td>17</td><td>25</td><td>33</td><td>41</td><td>49</td><td>57</td></tr>
          <tr><td>3</td><td>11</td><td>19</td><td>27</td><td>35</td><td>43</td><td>51</td><td>59</td></tr>
          <tr><td>5</td><td>13</td><td>21</td><td>29</td><td>37</td><td>45</td><td>53</td><td>61</td></tr>
          <tr><td>7</td><td>15</td><td>23</td><td>31</td><td>39</td><td>47</td><td>55</td><td>63</td></tr>
        </tbody>
      </table>
      <label>
        <input type="checkbox" class="cardCheck" data-value="1">
        åœ¨è¿™é‡Œé¢çœ‹åˆ°ä½ çš„æ•°å­—ï¼Ÿ
      </label>
    </div>

    <!-- å¡ç‰‡2ï¼šbit1=2 -->
    <div class="card" id="card2">
      <h3>å¡ç‰‡ 2</h3>
      <table>
        <tbody>
          <tr><td>2</td><td>10</td><td>18</td><td>26</td><td>34</td><td>42</td><td>50</td><td>58</td></tr>
          <tr><td>3</td><td>11</td><td>19</td><td>27</td><td>35</td><td>43</td><td>51</td><td>59</td></tr>
          <tr><td>6</td><td>14</td><td>22</td><td>30</td><td>38</td><td>46</td><td>54</td><td>62</td></tr>
          <tr><td>7</td><td>15</td><td>23</td><td>31</td><td>39</td><td>47</td><td>55</td><td>63</td></tr>
        </tbody>
      </table>
      <label>
        <input type="checkbox" class="cardCheck" data-value="2">
        åœ¨è¿™é‡Œé¢çœ‹åˆ°ä½ çš„æ•°å­—ï¼Ÿ
      </label>
    </div>

    <!-- å¡ç‰‡3ï¼šbit2=4 -->
    <div class="card" id="card3">
      <h3>å¡ç‰‡ 3</h3>
      <table>
        <tbody>
          <tr><td>4</td><td>12</td><td>20</td><td>28</td><td>36</td><td>44</td><td>52</td><td>60</td></tr>
          <tr><td>5</td><td>13</td><td>21</td><td>29</td><td>37</td><td>45</td><td>53</td><td>61</td></tr>
          <tr><td>6</td><td>14</td><td>22</td><td>30</td><td>38</td><td>46</td><td>54</td><td>62</td></tr>
          <tr><td>7</td><td>15</td><td>23</td><td>31</td><td>39</td><td>47</td><td>55</td><td>63</td></tr>
        </tbody>
      </table>
      <label>
        <input type="checkbox" class="cardCheck" data-value="4">
        åœ¨è¿™é‡Œé¢çœ‹åˆ°ä½ çš„æ•°å­—ï¼Ÿ
      </label>
    </div>

    <!-- å¡ç‰‡4ï¼šbit3=8 -->
    <div class="card" id="card4">
      <h3>å¡ç‰‡ 4</h3>
      <table>
        <tbody>
          <tr><td>8</td><td>12</td><td>24</td><td>28</td><td>40</td><td>44</td><td>56</td><td>60</td></tr>
          <tr><td>9</td><td>13</td><td>25</td><td>29</td><td>41</td><td>45</td><td>57</td><td>61</td></tr>
          <tr><td>10</td><td>14</td><td>26</td><td>30</td><td>42</td><td>46</td><td>58</td><td>62</td></tr>
          <tr><td>11</td><td>15</td><td>27</td><td>31</td><td>43</td><td>47</td><td>59</td><td>63</td></tr>
        </tbody>
      </table>
      <label>
        <input type="checkbox" class="cardCheck" data-value="8">
        åœ¨è¿™é‡Œé¢çœ‹åˆ°ä½ çš„æ•°å­—ï¼Ÿ
      </label>
    </div>

    <!-- å¡ç‰‡5ï¼šbit4=16 -->
    <div class="card" id="card5">
      <h3>å¡ç‰‡ 5</h3>
      <table>
        <tbody>
          <tr><td>16</td><td>20</td><td>24</td><td>28</td><td>48</td><td>52</td><td>56</td><td>60</td></tr>
          <tr><td>17</td><td>21</td><td>25</td><td>29</td><td>49</td><td>53</td><td>57</td><td>61</td></tr>
          <tr><td>18</td><td>22</td><td>26</td><td>30</td><td>50</td><td>54</td><td>58</td><td>62</td></tr>
          <tr><td>19</td><td>23</td><td>27</td><td>31</td><td>51</td><td>55</td><td>59</td><td>63</td></tr>
        </tbody>
      </table>
      <label>
        <input type="checkbox" class="cardCheck" data-value="16">
        åœ¨è¿™é‡Œé¢çœ‹åˆ°ä½ çš„æ•°å­—ï¼Ÿ
      </label>
    </div>

    <!-- å¡ç‰‡6ï¼šbit5=32 -->
    <div class="card" id="card6">
      <h3>å¡ç‰‡ 6</h3>
      <table>
        <tbody>
          <tr><td>32</td><td>36</td><td>40</td><td>44</td><td>48</td><td>52</td><td>56</td><td>60</td></tr>
          <tr><td>33</td><td>37</td><td>41</td><td>45</td><td>49</td><td>53</td><td>57</td><td>61</td></tr>
          <tr><td>34</td><td>38</td><td>42</td><td>46</td><td>50</td><td>54</td><td>58</td><td>62</td></tr>
          <tr><td>35</td><td>39</td><td>43</td><td>47</td><td>51</td><td>55</td><td>59</td><td>63</td></tr>
        </tbody>
      </table>
      <label>
        <input type="checkbox" class="cardCheck" data-value="32">
        åœ¨è¿™é‡Œé¢çœ‹åˆ°ä½ çš„æ•°å­—ï¼Ÿ
      </label>
    </div>

  </div><!-- /.card-container -->

  <div class="controls">
    <button id="guessBtn">è¯»å¿ƒæœ¯</button>
    <button id="revealBtn">æ­ç§˜</button>
  </div>

  <div id="resultArea"></div>

</div><!-- /.container -->

<footer>
  @å­™ç»´åˆšæ•™è‚²ç ”ç©¶é™¢
</footer>

<!-- å¼¹çª—å®¹å™¨ï¼ˆå…±ç”¨ï¼‰ -->
<div id="modalOverlay" class="modal-overlay">
  <div class="modal-content" id="modalContent">
    <!-- å†…å®¹å°†ç”± JS åŠ¨æ€ç”Ÿæˆ -->
  </div>
</div>

<script>
  // è·å–æ‰€æœ‰å…ƒç´ 
  const cardChecks = document.querySelectorAll('.cardCheck');
  const allCards = document.querySelectorAll('.card');
  const guessBtn = document.getElementById('guessBtn');
  const revealBtn = document.getElementById('revealBtn');
  const resultArea = document.getElementById('resultArea');
  
  // å¼¹çª—ç›¸å…³å…ƒç´ 
  const modalOverlay = document.getElementById('modalOverlay');
  const modalContent = document.getElementById('modalContent');

  let currentNumber = 0;
  let isRevealMode = false;

  // ç¥ç§˜å°è¯åº“
  const mysteryPhrases = [
    "æˆ‘çŒœçŒœï¼Œä½ æƒ³çš„æ•°å­—æ˜¯â€¦â€¦",
    "æˆ‘æ¥æ–½åŠ é­”æ³•ï¼Œä½ æƒ³çš„æ•°å­—æ˜¯â€¦â€¦",
    "æ­£åœ¨æ„Ÿåº”ä½ çš„è„‘ç”µæ³¢â€¦â€¦",
    "æ˜Ÿè¾°æŒ‡å¼•ç€æˆ‘ï¼Œç­”æ¡ˆæ˜¯â€¦â€¦",
    "é€è¿‡äºŒè¿›åˆ¶çš„è¿·é›¾ï¼Œæˆ‘çœ‹åˆ°äº†â€¦â€¦",
    "çœŸç›¸åªæœ‰ä¸€ä¸ªï¼Œé‚£å°±æ˜¯â€¦â€¦"
  ];

  // åˆå§‹åŒ–ï¼šä¿å­˜åŸå§‹æ•°æ®åˆ° dataset
  document.querySelectorAll('.card td').forEach(td => {
    td.dataset.origin = td.innerText;
  });

  // å…¨å±€é‡ç½®å‡½æ•°
  function resetGame() {
    // 1. æ¸…ç©ºæ‰€æœ‰å‹¾é€‰
    cardChecks.forEach(chk => chk.checked = false);
    
    // 2. é‡ç½®å†…éƒ¨çŠ¶æ€
    currentNumber = 0;
    
    // 3. æ¸…ç©ºç»“æœæ˜¾ç¤º
    resultArea.innerHTML = '';
    
    // 4. é‡ç½®æ­ç§˜æ¨¡å¼ï¼ˆå»æ‰è¾¹æ¡†ç­‰ï¼‰
    resetRevealMode();
    
    // 5. æŒ‰é’®çŠ¶æ€å¤åŸ
    guessBtn.innerText = 'è¯»å¿ƒæœ¯';
    guessBtn.classList.remove('restart-mode');
  }

  // ã€è¯»å¿ƒæœ¯ / é‡æ–°å¼€å§‹ã€‘æŒ‰é’®
  guessBtn.addEventListener('click', function() {
    // å¦‚æœæŒ‰é’®æ˜¾ç¤ºä¸ºâ€œé‡æ–°å¼€å§‹â€ï¼Œåˆ™æ‰§è¡Œé‡ç½®é€»è¾‘
    if (this.innerText === 'é‡æ–°å¼€å§‹') {
      resetGame();
      return;
    }

    // æ­£å¸¸â€œè¯»å¿ƒæœ¯â€é€»è¾‘
    let sum = 0;
    cardChecks.forEach(chk => {
      if (chk.checked) {
        sum += parseInt(chk.dataset.value, 10);
      }
    });
    currentNumber = sum;

    // æ¯æ¬¡è®¡ç®—å‰ç¡®ä¿ä¸åœ¨æ­ç§˜æ¨¡å¼
    resetRevealMode();

    if (sum > 0 && sum <= 63) {
      // 1. éšæœºé€‰æ‹©ä¸€å¥å°è¯
      const randomPhrase = mysteryPhrases[Math.floor(Math.random() * mysteryPhrases.length)];
      
      // 2. å¼¹å‡ºâ€œè¯»å¿ƒç»“æœâ€å¼¹çª—
      modalContent.innerHTML = `
        <div class="modal-header">
          <h2 class="magic-result-title">ğŸ”® è¯»å¿ƒæ—¶åˆ» ğŸ”®</h2>
        </div>
        <div class="magic-phrase">${randomPhrase}</div>
        <div class="magic-number">${sum}</div>
        <div class="close-hint">ï¼ˆç‚¹å‡»ä»»æ„å¤„å…³é—­ï¼‰</div>
      `;
      modalOverlay.classList.add('show');

      // 3. åŒæ—¶æ›´æ–°é¡µé¢åº•éƒ¨çš„ resultArea
      resultArea.innerHTML = `
        <p>ä½ å¿ƒä¸­æƒ³çš„æ•°å­—æ˜¯ï¼š<span class="highlight">${sum}</span></p>
        <p>ï¼ˆç‚¹å‡»â€œæ­ç§˜â€æŸ¥çœ‹åŸç†ï¼‰</p>
      `;

    } else if (sum === 0) {
      modalContent.innerHTML = `
        <div class="modal-header"><h2>ğŸ¤” å—¯ï¼Ÿ</h2></div>
        <p>æ°´æ™¶çƒä¸€ç‰‡æ¨¡ç³Šâ€¦â€¦</p>
        <p>ä½ å¥½åƒæ²¡æœ‰å‹¾é€‰ä»»ä½•å¡ç‰‡å“¦ã€‚</p>
        <div class="close-hint">ï¼ˆç‚¹å‡»ä»»æ„å¤„å…³é—­ï¼‰</div>
      `;
      modalOverlay.classList.add('show');
      resultArea.innerHTML = `<p>ä½ æ²¡æœ‰å‹¾é€‰ä»»ä½•å¡ç‰‡ï¼Œä¹Ÿè®¸ä½ æƒ³çš„æ•°å­—æ˜¯ 0 æˆ–å¤§äº 63ï¼Ÿ</p>`;
    } else {
      resultArea.innerHTML = `<p>ä¼¼ä¹è¶…è¿‡ 63ï¼Œæˆ–æš‚æ— æ³•è¾¨è¯†ã€‚</p>`;
    }
  });

  // ã€æ­ç§˜ã€‘æŒ‰é’®
  revealBtn.addEventListener('click', function() {
    // åˆ‡æ¢æŒ‰é’®æ–‡å­—ä¸ºâ€œé‡æ–°å¼€å§‹â€
    guessBtn.innerText = 'é‡æ–°å¼€å§‹';
    guessBtn.classList.add('restart-mode');

    if (currentNumber > 0 && currentNumber <= 63) {
      let binStr = currentNumber.toString(2).padStart(6, '0'); 
      const bitLabels = [32, 16, 8, 4, 2, 1];
      let detail = '';
      for (let i = 0; i < 6; i++) {
        detail += `<li>äºŒè¿›åˆ¶ä½ <strong>${6 - i}</strong> (æƒå€¼=${bitLabels[i]})ï¼š
                    <strong>${binStr[i]}</strong> 
                    ${binStr[i] === '1' ? 'ï¼ˆä½ å‹¾é€‰äº†å¯¹åº”å¡ç‰‡ï¼‰' : 'ï¼ˆä½ æ²¡æœ‰å‹¾é€‰ï¼‰'}
                  </li>`;
      }

      resultArea.innerHTML = `
        <p>ä½ å¿ƒä¸­æƒ³çš„æ•°å­—æ˜¯ï¼š<span class="highlight">${currentNumber}</span></p>
        <p>å®ƒçš„ 6 ä½äºŒè¿›åˆ¶å½¢å¼ä¸ºï¼š<span class="highlight">${binStr}</span></p>
        <ul>${detail}</ul>
        <p>åŸç†ï¼šå‡¡æ˜¯ä½å€¼ä¸º 1 çš„å¡ç‰‡è¢«å‹¾é€‰ï¼ŒæŠŠè¿™äº›ä½å¯¹åº”çš„æ•°å€¼ç›¸åŠ ï¼Œå°±å¾—åˆ° <strong>${currentNumber}</strong>ï¼</p>
        <span class="instruction-tip">âœ¨ ç°åœ¨çš„ä½ å¯ä»¥ç‚¹å‡»ä¸Šæ–¹çš„ä»»æ„å¡ç‰‡ï¼Œå¼¹çª—æ”¾å¤§æŸ¥çœ‹å…¶ä¸­çš„äºŒè¿›åˆ¶å¥¥ç§˜ï¼</span>
      `;
    } else {
      resultArea.innerHTML = `
        <p>è¯·å…ˆé€‰æ‹©å¡ç‰‡å¹¶ç‚¹å‡»â€œè¯»å¿ƒæœ¯â€ï¼Œç¡®å®šä¸€ä¸ªæ•°å­—åå†æ¥æ­ç§˜ã€‚</p>
        <span class="instruction-tip">ä¸è¿‡ï¼Œä½ ç°åœ¨ä¾ç„¶å¯ä»¥ç‚¹å‡»ä¸Šæ–¹å¡ç‰‡ï¼Œæ¢ç´¢å®ƒä»¬èƒŒåçš„äºŒè¿›åˆ¶è§„å¾‹ã€‚</span>
      `;
    }
    activateRevealMode();
  });

  function activateRevealMode() {
    isRevealMode = true;
    revealBtn.classList.add('active');
    allCards.forEach(card => card.classList.add('reveal-active'));
  }

  function resetRevealMode() {
    isRevealMode = false;
    revealBtn.classList.remove('active');
    allCards.forEach(card => card.classList.remove('reveal-active'));
    closeModal();
  }

  // ç‚¹å‡»å¡ç‰‡äº‹ä»¶ï¼ˆæ­ç§˜æ¨¡å¼ï¼‰
  allCards.forEach(card => {
    card.addEventListener('click', function(e) {
      if (!isRevealMode) return;
      if (e.target.tagName === 'INPUT' || e.target.tagName === 'LABEL') return;
      openCardModal(card);
    });
  });

  // æ‰“å¼€å¡ç‰‡è¯¦æƒ…å¼¹çª—ï¼ˆæ­ç§˜æ¨¡å¼ï¼‰
  function openCardModal(card) {
    const checkbox = card.querySelector('.cardCheck');
    const cardValue = parseInt(checkbox.dataset.value, 10);
    const title = card.querySelector('h3').innerText;

    const highlightIndex = 5 - Math.log2(cardValue);
    const originTds = Array.from(card.querySelectorAll('td')).map(td => td.dataset.origin);

    // æ„å»ºè¡¨æ ¼ HTML
    let tableHtml = '<table class="modal-table"><tbody>';
    let dataIndex = 0;
    for (let r = 0; r < 4; r++) {
      tableHtml += '<tr>';
      for (let c = 0; c < 8; c++) {
        if (dataIndex < originTds.length) {
          const num = parseInt(originTds[dataIndex], 10);
          const binStr = num.toString(2).padStart(6, '0');
          const prefix = binStr.substring(0, highlightIndex);
          const targetBit = binStr[highlightIndex];
          const suffix = binStr.substring(highlightIndex + 1);
          
          const cellContent = `
            <div class="cell-decimal">${num}</div>
            <div class="cell-binary">
              ${prefix}<span class="modal-bit-highlight">${targetBit}</span>${suffix}
            </div>
          `;
          tableHtml += `<td>${cellContent}</td>`;
          dataIndex++;
        }
      }
      tableHtml += '</tr>';
    }
    tableHtml += '</tbody></table>';

    // é‡æ„ Modal å†…å®¹
    modalContent.innerHTML = `
      <div class="modal-header">
        <h2 id="modalTitle">${title} (ä½å€¼: ${cardValue})</h2>
        <div class="modal-tip">ä¸Šæ–¹ä¸ºåè¿›åˆ¶æ•°å­—ï¼Œä¸‹æ–¹ä¸ºäºŒè¿›åˆ¶æ•°å­—ï¼ˆçº¢è‰²ä½è¡¨ç¤ºå½“å‰å¡ç‰‡å¯¹åº”çš„ä½å€¼ï¼‰</div>
      </div>
      <div id="modalTableContainer">${tableHtml}</div>
      <div class="close-hint">ï¼ˆç‚¹å‡»ä»»æ„å¤„å…³é—­ï¼‰</div>
    `;

    modalOverlay.classList.add('show');
  }

  // å…³é—­å¼¹çª—
  function closeModal() {
    modalOverlay.classList.remove('show');
  }

  modalOverlay.addEventListener('click', closeModal);

</script>

</body>
</html>
